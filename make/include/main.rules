.DELETE_ON_ERROR:
.SUFFIXES:

###############################################################################

## file-wide conditional to use xcode rules if xcode=1 method=terminal
ifeq ($(FEATURE.xcode):$(BUILD.method),1:terminal)
    include $(PROJECT/)macosx/module.xcode
else

## only included using special report targets
ifneq (,$(REPORT))
    include $(PROJECT/)make/include/report.defs
endif

###############################################################################

.PHONY: build install clean xclean doc report

build:
install:
clean:
xclean: contrib.xclean clean
doc:
report:: report.main report.modules

## legacy
mrproper: xclean

###############################################################################

include $(MODULES:%=$(PROJECT/)%/module.rules)
-include $(PROJECT/)make/variant/$(HOST.system).rules
-include $(PROJECT/)make/variant/$(HOST.system).$(BUILD.machine).rules

###############################################################################

## target which causes re-configure if project-root is svn update'd
$(BUILD/)GNUmakefile: $(wildcard $(PROJECT/).svn/entries)
	$(PROJECT/)configure $(CONF.args)

## target useful to force reconfigure; only helpful for build-system development
.PHONY: reconfigure
reconfigure:
	$(PROJECT/)configure $(CONF.args)

###############################################################################

## target to build all dependency dirs
$(sort $(dir $(BUILD.out))):
	$(MKDIR.exe) -p $@

endif ## xcode=1 method=terminal
